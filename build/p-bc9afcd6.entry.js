import{r as s,h as i,H as t,g as o}from"./p-27ce4408.js";import{Y as e,d as a,t as r}from"./p-0f8eda08.js";import{b as n,c as d}from"./p-9a472600.js";import{u as c}from"./p-39f4a1b5.js";import{t as l}from"./p-ed06eb0a.js";import{g as p,d as h,m}from"./p-7b8d1737.js";import{S as b}from"./p-c96f589c.js";import{f as v,t as u}from"./p-366ee10f.js";import"./p-5304e58c.js";import"./p-b44dc71b.js";import"./p-ef6ec345.js";const f=Intl.NumberFormat("en",{notation:"compact"});let g=class{constructor(i){s(this,i),this.preloadStream=!1,this.showVideoPreview=!1,this.handleImageLoad=()=>{this.preloadStream&&!this.stream&&this.getStream().pipe(l(1)).subscribe(this.setStream)},this.setStream=s=>{this.stream=s},this.getStream=()=>this.stream?p(this.stream):e.getApi().getStream(this.video.videoId),this.destroy$=new b}get subDescription(){const{video:s}=this;return["",...s.views?[f.format(s.views)]:[],s.uploadedDate].join(" â€§ ")}get thumbnail(){var s;return(null===(s=this.stream)||void 0===s?void 0:s.thumbnail)||this.video.thumbnail}componentDidLoad(){const s=this.el.querySelector(".card"),i=v(s,"mouseleave"),t=v(s,"mouseenter").pipe(h((()=>u(300).pipe(r(i)))),h(this.getStream));t.pipe(c(this,"disconnectedCallback")).subscribe((s=>{this.setStream(s)}));const o=t.pipe(m((()=>!0))),e=a(i,this.destroy$).pipe(m((()=>!1)));a(o,e).pipe(c(this,"disconnectedCallback")).subscribe((s=>{this.showVideoPreview=s}))}render(){const{video:s,subDescription:o}=this;return i(t,null,i("div",{class:"card"},i("img",{class:"thumbnail",src:this.thumbnail}),i("div",{class:"video-preview"},this.stream&&this.showVideoPreview&&i("video-player",{sources:this.stream.sources,muted:!0})),i("div",{class:"video-desc"},i("img",{class:"uploader-avatar",onLoad:this.handleImageLoad,src:s.uploaderAvatar}),i("span",{class:"avatar-right"},i("h3",null,s.title),i("p",{class:"sub-desc"},i("span",null,s.uploaderName),!!s.uploaderVerified&&i("x-icon",{icon:n}),i("span",null,o))),this.deleteCallback&&i("icon-btn",{class:"delete-btn",icon:d,onClick:s=>{s.stopPropagation()},onBtnClicked:()=>{this.deleteCallback(s)}}))))}disconnectedCallback(){this.destroy$.next(),this.destroy$.complete()}get el(){return o(this)}};g.style='@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}:host{display:block}.delete-btn{--padding:0 10px}@keyframes spin{0%{transform:translate(-50%, -50%) rotate(0deg)}100%{transform:translate(-50%, -50%) rotate(360deg)}}.card{overflow:hidden;position:relative}.card .video-preview{top:0;position:absolute;width:100%;aspect-ratio:16/9;background:white;visibility:hidden}.card .video-preview::before{content:"";display:block;width:40px;height:40px;border:4px solid #ccc;border-top-color:#333;border-radius:50%;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);animation:spin 1s linear infinite}.card:hover .video-preview{visibility:visible}.card:hover .thumbnail{visibility:hidden}';export{g as card_video}