import{r as t,h as i,H as s}from"./p-27ce4408.js";import{a as o,f as n,b as a,m as e,k as l}from"./p-9a472600.js";import{j as r,n as c,o as p,s as h,p as d,a as m,i as u,g as b,h as f,f as g}from"./p-ffdfb00a.js";import{S as k}from"./p-fae28420.js";import{l as j,o as v,c as x,i as y,m as C}from"./p-3b7085e5.js";import{t as w}from"./p-6ad5c5be.js";import{f as L}from"./p-89687980.js";import{O as S}from"./p-9f34646c.js";import{M as B}from"./p-515fbc07.js";import{A as O}from"./p-2d1a0235.js";import"./p-954d5885.js";import"./p-b44dc71b.js";import"./p-674acdd7.js";function z(t,i=p,s){const o=function(t=0,i,s=c){let o=-1;return null!=i&&(j(i)?s=i:o=i),new S((i=>{let n=r(t)?+t-s.now():t;n<0&&(n=0);let a=0;return s.schedule((function(){i.closed||(i.next(a++),0<=o?this.schedule(void 0,o):i.complete())}),n)}))}(t,i);return function(t,i){return v(((t,s)=>{const{leading:n=!0,trailing:a=!1}=null!=i?i:{};let e=!1,l=null,r=null,c=!1;const p=()=>{null==r||r.unsubscribe(),r=null,a&&(m(),c&&s.complete())},h=()=>{r=null,c&&s.complete()},d=()=>r=y(o).subscribe(x(s,p,h)),m=()=>{if(e){e=!1;const t=l;l=null,s.next(t),!c&&d()}};t.subscribe(x(s,(t=>{e=!0,l=t,(!r||r.closed)&&(n?m():d())}),(()=>{c=!0,(!(a&&e&&r)||r.closed)&&s.complete()})))}))}(0,s)}let A=class{constructor(i){t(this,i),this.commentsList=[],this.disconnected$=new k}componentWillLoad(){h.pipe(C((t=>t.videoPage)),w(this.disconnected$)).subscribe((t=>{this.comments!==t.comments&&(this.comments=t.comments,this.commentsList=[...this.commentsList,...t.comments.comments]),this.commentsView=t.commentsView,this.areCommentsLoading=t.areCommentsLoading}))}componentDidLoad(){L(this.commentList,"scroll").pipe(d((()=>{return t=this.commentList,Math.abs(t.scrollHeight-t.scrollTop-t.clientHeight)<1;var t})),z(200),w(this.disconnected$)).subscribe((()=>{m.dispatch(u(Object.assign(Object.assign({},this.commentsView),{nextpage:this.comments.nextpage})))}))}disconnectedCallback(){this.disconnected$.next(),this.disconnected$.complete()}render(){const t=this.commentsList;return i(s,null,i("div",{class:"comments-view"},i("icon-btn",{class:"close-btn",icon:o,onBtnClicked:this.closeCallback}),i("h3",{class:"heading"},"Comments"),i("ul",{ref:t=>{this.commentList=t},class:"list"},t.map((t=>i("li",null,i("a-comment",{comment:t,key:t.commentId}))))),this.areCommentsLoading&&i("x-icon",{icon:n,spin:!0})))}};A.style="@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}:host{display:block}.comments-view{position:relative;background-color:#8c5383;height:100%;border-top-left-radius:15px;border-top-right-radius:15px;display:flex;flex-direction:column}.comments-view .close-btn{position:absolute;right:0;top:0;padding:10px}.heading{padding:10px;margin:0}.list{margin:0;list-style-type:none;padding-right:10px;padding-left:10px;padding-bottom:10px;overflow-y:auto}.list li~li{margin-top:10px}";let M=0;const T="share-cb"+ ++M;let W=class{constructor(i){t(this,i),this.disconnected$=new k,this.handleCopyLink=async t=>{var i;(i=t,navigator.clipboard.writeText(i)).then((()=>{m.dispatch(b(t))}))},this.handleShare=t=>{navigator.share({url:t,title:this.video.title||"A YouTube Video"})}}componentWillLoad(){h.pipe(C((t=>t.videoPage)),w(this.disconnected$)).subscribe((t=>{this.shareForm=t.shareForm,this.currentTimeEnabled=t.currentTimeEnabled,this.copiedLink=t.copiedLink}))}disconnectedCallback(){this.disconnected$.next(),this.disconnected$.complete()}render(){let t=O.getCurrentSpaUrl();return this.currentTimeEnabled&&(t+="?t="+this.shareForm.currentTime),i(s,null,i(B,{onClose:()=>m.dispatch(f(void 0))},i("form",{class:"share-form",onSubmit:t=>{t.preventDefault()}},i("input",{type:"checkbox",id:T,checked:this.currentTimeEnabled,onClick:()=>{m.dispatch(g(!this.currentTimeEnabled))}}),i("label",{htmlFor:T},i("span",null,"Share with Current Time?")),i("p",null,t),i("div",{class:"share-actions"},i("icon-btn",{icon:this.copiedLink?a:e,label:this.copiedLink?"Copied!":"Copy Link",size:"small",onBtnClicked:()=>{this.handleCopyLink(t)}}),!!navigator.share&&i("icon-btn",{icon:l,label:"Share",size:"small",onBtnClicked:()=>{this.handleShare(t)}})))))}};W.style="@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}input[type=checkbox]{position:relative;top:2px}";export{A as comments_view,W as share_form}