import{r as t,h as i,H as s}from"./p-27ce4408.js";import{a as o,f as n,b as a,m as e,k as l}from"./p-9a472600.js";import{s as r,j as c,a as p,i as h,g as m,h as d,f as u}from"./p-c472acb9.js";import{S as b}from"./p-c96f589c.js";import{o as f,c as g,i as k,m as j}from"./p-7b8d1737.js";import{b as x,t as v}from"./p-0f8eda08.js";import{t as y,f as C}from"./p-366ee10f.js";import{M as w}from"./p-515fbc07.js";import{A as L}from"./p-2d1a0235.js";import"./p-954d5885.js";import"./p-5304e58c.js";import"./p-b44dc71b.js";import"./p-ef6ec345.js";function S(t,i=x,s){const o=y(t,i);return function(t,i){return f(((t,s)=>{const{leading:n=!0,trailing:a=!1}=null!=i?i:{};let e=!1,l=null,r=null,c=!1;const p=()=>{null==r||r.unsubscribe(),r=null,a&&(d(),c&&s.complete())},h=()=>{r=null,c&&s.complete()},m=()=>r=k(o).subscribe(g(s,p,h)),d=()=>{if(e){e=!1;const t=l;l=null,s.next(t),!c&&m()}};t.subscribe(g(s,(t=>{e=!0,l=t,(!r||r.closed)&&(n?d():m())}),(()=>{c=!0,(!(a&&e&&r)||r.closed)&&s.complete()})))}))}(0,s)}let B=class{constructor(i){t(this,i),this.commentsList=[],this.disconnected$=new b}componentWillLoad(){r.pipe(j((t=>t.videoPage)),v(this.disconnected$)).subscribe((t=>{this.comments!==t.comments&&(this.comments=t.comments,this.commentsList=[...this.commentsList,...t.comments.comments]),this.commentsView=t.commentsView,this.areCommentsLoading=t.areCommentsLoading}))}componentDidLoad(){C(this.commentList,"scroll").pipe(c((()=>{return t=this.commentList,Math.abs(t.scrollHeight-t.scrollTop-t.clientHeight)<1;var t})),S(200),v(this.disconnected$)).subscribe((()=>{p.dispatch(h(Object.assign(Object.assign({},this.commentsView),{nextpage:this.comments.nextpage})))}))}disconnectedCallback(){this.disconnected$.next(),this.disconnected$.complete()}render(){const t=this.commentsList;return i(s,null,i("div",{class:"comments-view"},i("icon-btn",{class:"close-btn",icon:o,onBtnClicked:this.closeCallback}),i("h3",{class:"heading"},"Comments"),i("ul",{ref:t=>{this.commentList=t},class:"list"},t.map((t=>i("li",null,i("a-comment",{comment:t,key:t.commentId}))))),this.areCommentsLoading&&i("x-icon",{icon:n,spin:!0})))}};B.style="@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}:host{display:block}.comments-view{position:relative;background-color:#8c5383;height:100%;border-top-left-radius:15px;border-top-right-radius:15px;display:flex;flex-direction:column}.comments-view .close-btn{position:absolute;right:0;top:0;padding:10px}.heading{padding:10px;margin:0}.list{margin:0;list-style-type:none;padding-right:10px;padding-left:10px;padding-bottom:10px;overflow-y:auto}.list li~li{margin-top:10px}";let z=0;const A="share-cb"+ ++z;let M=class{constructor(i){t(this,i),this.disconnected$=new b,this.handleCopyLink=async t=>{var i;(i=t,navigator.clipboard.writeText(i)).then((()=>{p.dispatch(m(t))}))},this.handleShare=t=>{navigator.share({url:t,title:this.video.title||"A YouTube Video"})}}componentWillLoad(){r.pipe(j((t=>t.videoPage)),v(this.disconnected$)).subscribe((t=>{this.shareForm=t.shareForm,this.currentTimeEnabled=t.currentTimeEnabled,this.copiedLink=t.copiedLink}))}disconnectedCallback(){this.disconnected$.next(),this.disconnected$.complete()}render(){let t=L.getCurrentSpaUrl();return this.currentTimeEnabled&&(t+="?t="+this.shareForm.currentTime),i(s,null,i(w,{onClose:()=>p.dispatch(d(void 0))},i("form",{class:"share-form",onSubmit:t=>{t.preventDefault()}},i("input",{type:"checkbox",id:A,checked:this.currentTimeEnabled,onClick:()=>{p.dispatch(u(!this.currentTimeEnabled))}}),i("label",{htmlFor:A},i("span",null,"Share with Current Time?")),i("p",null,t),i("div",{class:"share-actions"},i("icon-btn",{icon:this.copiedLink?a:e,label:this.copiedLink?"Copied!":"Copy Link",size:"small",onBtnClicked:()=>{this.handleCopyLink(t)}}),!!navigator.share&&i("icon-btn",{icon:l,label:"Share",size:"small",onBtnClicked:()=>{this.handleShare(t)}})))))}};M.style="@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}input[type=checkbox]{position:relative;top:2px}";export{B as comments_view,M as share_form}