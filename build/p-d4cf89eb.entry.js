import{r as i,h as t,H as s,g as o}from"./p-27ce4408.js";import{Y as e,t as r}from"./p-6ad5c5be.js";import{b as a,c as n}from"./p-9a472600.js";import{t as d}from"./p-88cc7230.js";import{f as c}from"./p-89687980.js";import{g as l}from"./p-3b7085e5.js";import"./p-9f34646c.js";import"./p-b44dc71b.js";import"./p-674acdd7.js";const p=Intl.NumberFormat("en",{notation:"compact"});let h=class{constructor(t){i(this,t),this.preloadStream=!1,this.showVideoPreview=!1,this.handleImageLoad=()=>{this.preloadStream&&!this.stream&&this.getStream().pipe(d(1)).subscribe(this.setStream)},this.setStream=i=>{this.stream=i},this.getStream=()=>e.getApi().getStream(this.video.videoId)}get subDescription(){const{video:i}=this;return["",...i.views?[p.format(i.views)]:[],i.uploadedDate].join(" â€§ ")}get thumbnail(){var i;return(null===(i=this.stream)||void 0===i?void 0:i.thumbnail)||this.video.thumbnail}componentDidLoad(){const i=this.el.querySelector(".card"),t=c(i,"mouseleave");c(i,"mouseenter").pipe(l(this.getStream),r(t)).subscribe((i=>{this.setStream(i),this.showVideoPreview=!0})),t.pipe(d(1)).subscribe((()=>{this.showVideoPreview=!1}))}render(){const{video:i,subDescription:o}=this;return t(s,null,t("div",{class:"card"},t("img",{class:"thumbnail",src:this.thumbnail}),t("div",{class:"video-preview"},this.stream&&this.showVideoPreview&&t("video-player",{sources:this.stream.sources,muted:!0,onLoaded:({detail:i})=>{i.player.play()}})),t("div",{class:"video-desc"},t("img",{class:"uploader-avatar",onLoad:this.handleImageLoad,src:i.uploaderAvatar}),t("span",{class:"avatar-right"},t("h3",null,i.title),t("p",{class:"sub-desc"},t("span",null,i.uploaderName),!!i.uploaderVerified&&t("x-icon",{icon:a}),t("span",null,o))),this.deleteCallback&&t("icon-btn",{class:"delete-btn",icon:n,onClick:i=>{i.stopPropagation()},onBtnClicked:()=>{this.deleteCallback(i)}}))))}get el(){return o(this)}};h.style='@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}:host{display:block}.delete-btn{--padding:0 10px}@keyframes spin{0%{transform:translate(-50%, -50%) rotate(0deg)}100%{transform:translate(-50%, -50%) rotate(360deg)}}.card{overflow:hidden;position:relative}.card .video-preview{top:0;position:absolute;width:100%;aspect-ratio:16/9;background:white;visibility:hidden}.card .video-preview::before{content:"";display:block;width:40px;height:40px;border:4px solid #ccc;border-top-color:#333;border-radius:50%;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);animation:spin 1s linear infinite}.card:hover .video-preview{visibility:visible}.card:hover .thumbnail{visibility:hidden}';export{h as card_video}