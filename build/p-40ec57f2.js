import{C as e}from"./p-b44dc71b.js";import{a as t}from"./p-bc5141d2.js";import{o as r,c as a,i,d as s,m as o}from"./p-c9444cc0.js";import{o as n}from"./p-a0dedc53.js";function u(e){return r(((t,r)=>{let s,o=null,n=!1;o=t.subscribe(a(r,void 0,void 0,(a=>{s=i(e(a,u(e)(t))),o?(o.unsubscribe(),o=null,s.subscribe(r)):n=!0}))),n&&(o.unsubscribe(),o=null,s.subscribe(r))}))}function l(e){return s((()=>t.get(e)))}function d(){return{comments:[],nextpage:"",disabled:!1}}const p={getApi:()=>new m};class m{getBaseUrl(){return e.get().apiUrl}getComments(e,t){let r=`${this.getBaseUrl()}/comments/${e}`;return t&&(r=`${this.getBaseUrl()}/nextpage/comments/${e}?nextpage=${t}`),l(r).pipe(o((e=>e.data)))}getSearchResults(e,t){let r=`${this.getBaseUrl()}/search?q=${e}&filter=videos`;return t&&(r=`${this.getBaseUrl()}/nextpage/search?q=${e}&filter=videos&nextpage=${t}`),l(r).pipe(o((e=>e.data)),o((e=>({results:e.items.map((e=>({videoId:e.url.split("/watch?v=")[1],thumbnail:e.thumbnail,title:e.title,uploaderAvatar:e.uploaderAvatar,uploaderName:e.uploaderName,uploadedDate:e.uploadedDate,uploaderVerified:e.uploaderVerified,views:e.views}))),nextpage:e.nextpage}))))}getStream(e){const t=e=>"stream"===e.type,r=({url:e})=>({url:e,mime:"application/x-mpegURL",quality:"Auto"}),a=e=>-1!==e.contentLength&&"video/webm"===e.mimeType&&!!e.url,i=e=>Object.assign(Object.assign({},e),{mime:e.mimeType});return l(`${this.getBaseUrl()}/streams/${e}`).pipe(o((e=>e.data)),o((s=>({sources:[...s.hls?[r({url:s.hls})]:[],...s.videoStreams.filter(a).map(i)],title:s.title,relatedVideos:s.relatedStreams.filter(t).map((e=>({videoId:e.url.split("/watch?v=")[1],thumbnail:e.thumbnail,title:e.title,uploaderAvatar:e.uploaderAvatar,uploaderName:e.uploaderName,uploadedDate:e.uploadedDate,uploaderVerified:e.uploaderVerified,views:e.views}))),likes:s.likes,dislikes:s.dislikes,uploader:s.uploader,uploaderAvatar:s.uploaderAvatar,uploaderSubscriberCount:s.uploaderSubscriberCount,uploaderVerified:s.uploaderVerified,views:s.views,uploadDate:s.uploadDate,thumbnail:s.thumbnailUrl,id:e}))))}getTrendingVideos(){return l(`${this.getBaseUrl()}/trending?region=IN`).pipe(o((e=>e.data)),o((e=>e.map((e=>({videoId:e.url.split("/watch?v=")[1],thumbnail:e.thumbnail,title:e.title,uploaderAvatar:e.uploaderAvatar,uploaderName:e.uploaderName,uploadedDate:e.uploadedDate,uploaderVerified:e.uploaderVerified,views:e.views}))))))}getSuggestions(e){return l(`${this.getBaseUrl()}/suggestions?query=${e}`).pipe(o((e=>e.data)))}getSkipSegments(e){return l(`${this.getBaseUrl()}/sponsors/${e}?category=["sponsor","interaction","selfpromo","music_offtopic"]`).pipe(o((e=>e.data.segments)),o((e=>e.map((e=>e.segment)))),u((()=>n([]))))}}export{p as Y,u as c,d as n}