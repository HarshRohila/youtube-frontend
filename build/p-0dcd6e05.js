import{a as t,c as r,Y as n}from"./p-a5a82152.js";import{o as s,c as e,e as o,b as a,d as i,m as u,s as c,f as l,g as m}from"./p-1707b666.js";import{m as f}from"./p-75c405c4.js";import{c as p,b as h}from"./p-6cf4a597.js";import{f as d}from"./p-1a9f0680.js";import{t as b}from"./p-73c5a77b.js";import{b as v,i as w}from"./p-483a08e8.js";const j=p((t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"})),E=p((t=>function(r=null){t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=r}));function g(t,r){const{first:n,each:i,with:u=y,scheduler:c=(null!=r?r:v),meta:l=null}=w(t)?{first:t}:"number"==typeof t?{each:t}:t;if(null==n&&null==i)throw new TypeError("No timeout provided.");return s(((t,r)=>{let s,m,f=null,p=0;const h=t=>{m=o(r,c,(()=>{try{s.unsubscribe(),a(u({meta:l,lastValue:f,seen:p})).subscribe(r)}catch(t){r.error(t)}}),t)};s=t.subscribe(e(r,(t=>{null==m||m.unsubscribe(),p++,r.next(f=t),i>0&&h(i)}),void 0,void 0,(()=>{(null==m?void 0:m.closed)||null==m||m.unsubscribe(),f=null}))),!p&&h(null!=n?"number"==typeof n?n:+n-c.now():i)}))}function y(t){throw new E(t)}function T(t=U){return s(((r,n)=>{let s=!1;r.subscribe(e(n,(t=>{s=!0,n.next(t)}),(()=>s?n.complete():n.error(t()))))}))}function U(){return new j}function A(){return i((()=>t.get("https://raw.githubusercontent.com/wiki/TeamPiped/Piped-Frontend/Instances.md"))).pipe(u((t=>t.data)),u((t=>{const r=[];var n=0;return t.split("\n").map((t=>{const s=t.split("|");if(s.length>=4){if(n<2)return void n++;r.push({name:s[0].trim(),apiUrl:s[1].trim(),locations:s[2].trim(),hasCdn:"Yes"===s[3].trim()})}})),r})))}const B={getActiveServer:()=>A().pipe(c((t=>{return l(t).pipe((s=t=>function(t){const s=n.getApi({baseUrl:t.apiUrl}),e=s.getTrendingVideos().pipe(g(500)),o=s.getStream("OgRoRBLZbUQ").pipe(g(500));return e.pipe(c((()=>o)),u((()=>!0)),r((()=>m(!1))))}(t).pipe(u((r=>{if(r)return t}))),h(e)?f(s,e,1):f(s,1)),d(Boolean),b(1),u((t=>t)),T((()=>new Error("No server found"))));var s,e})))};export{B as A,j as E,A as g,g as t}