import{h as i,r as s,F as t,H as o}from"./p-958591d1.js";import{Y as e}from"./p-71205749.js";import{a as n,b as a,j as r,n as h,o as l,p as c}from"./p-d315f463.js";import{A as d}from"./p-293ffef4.js";import{R as p}from"./p-a215f906.js";import{A as m}from"./p-2d1a0235.js";import{V as f}from"./p-712f3b6e.js";import{S as u,t as g}from"./p-c0874b44.js";import"./p-6ad30cec.js";function b({onHeaderClick:s}){return i("header",null,i("h1",{onClick:s},d))}let v=class{constructor(i){s(this,i),this.disconnected$=new u,this.routeChange$=new u,this.share=()=>{if(navigator.share){const i=m.getCurrentSpaUrl();navigator.share({url:i,title:this.stream.title||"A YouTube Video"})}else n.dispatch(a({message:"Sharing not supported in your Device for now"}))},this.handleHeaderClick=()=>{new p(this.history).showTrendingPage()},this.handleVideoClick=i=>{new p(this.history).showVideoPage(i)}}componentWillLoad(){const i=this.match.params.videoId;this.history.listen((({pathname:i})=>{const s=i.split("/").pop();this.routeChange$.next({videoId:s})})),this.routeChange$.pipe(g(this.disconnected$)).subscribe((({videoId:i})=>{this.fetchVideo(i)})),this.fetchVideo(i)}fetchVideo(i){n.dispatch(r(!0)),window.scrollTo({top:0,behavior:"smooth"}),e.getApi().getStream(i).pipe(g(this.disconnected$)).subscribe({next:i=>{this.stream=i,n.dispatch(r(!1))},error:()=>{this.error={message:"Failed to load video. Please try refreshing"},n.dispatch(r(!1))}})}get url(){return this.stream.sources[0].url}disconnectedCallback(){this.disconnected$.next(),this.disconnected$.complete()}render(){return i(o,null,i("div",{class:"video-page"},i(b,{onHeaderClick:this.handleHeaderClick}),this.stream&&i(t,null,i("video-player",{src:this.url}),i("h3",null,this.stream.title),i("div",{class:"actions"},i("icon-btn",{icon:h,label:j.format(this.stream.likes),disabled:!0}),i("icon-btn",{icon:l,label:j.format(this.stream.dislikes),disabled:!0}),i("icon-btn",{icon:c,onBtnClicked:this.share,label:"Share"}))),this.error&&i("h3",null,this.error.message),this.stream&&i("h3",null,"You may also like"),this.stream&&i(f,{videos:this.stream.relatedVideos,isShowingSuggestions:!1,onClickVideo:this.handleVideoClick})))}};const j=Intl.NumberFormat("en",{notation:"compact"});v.style="@keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}.video-page{min-height:100vh}.video-page header{width:100%;display:flex;align-items:center;justify-content:center;position:static}h3{margin:16px}.actions{display:flex;justify-content:space-evenly}";export{v as video_page}