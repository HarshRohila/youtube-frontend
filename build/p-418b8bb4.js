import{a as t,c as r,Y as n}from"./p-a5a82152.js";import{o as e,c as s,e as o,b as a,d as i,m as u,s as c,f as l,g as m}from"./p-1707b666.js";import{m as f}from"./p-75c405c4.js";import{c as p,b as h}from"./p-6cf4a597.js";import{f as d}from"./p-1a9f0680.js";import{t as b}from"./p-73c5a77b.js";import{b as v,i as w}from"./p-ee839885.js";const j=p((t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"})),g=p((t=>function(r=null){t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=r}));function y(t,r){const{first:n,each:i,with:u=E,scheduler:c=(null!=r?r:v),meta:l=null}=w(t)?{first:t}:"number"==typeof t?{each:t}:t;if(null==n&&null==i)throw new TypeError("No timeout provided.");return e(((t,r)=>{let e,m,f=null,p=0;const h=t=>{m=o(r,c,(()=>{try{e.unsubscribe(),a(u({meta:l,lastValue:f,seen:p})).subscribe(r)}catch(t){r.error(t)}}),t)};e=t.subscribe(s(r,(t=>{null==m||m.unsubscribe(),p++,r.next(f=t),i>0&&h(i)}),void 0,void 0,(()=>{(null==m?void 0:m.closed)||null==m||m.unsubscribe(),f=null}))),!p&&h(null!=n?"number"==typeof n?n:+n-c.now():i)}))}function E(t){throw new g(t)}function T(t=U){return e(((r,n)=>{let e=!1;r.subscribe(s(n,(t=>{e=!0,n.next(t)}),(()=>e?n.complete():n.error(t()))))}))}function U(){return new j}function A(){return i((()=>t.get("https://raw.githubusercontent.com/wiki/TeamPiped/Piped-Frontend/Instances.md"))).pipe(u((t=>t.data)),u((t=>{const r=[];var n=0;return t.split("\n").map((t=>{const e=t.split("|");if(e.length>=4){if(n<2)return void n++;r.push({name:e[0].trim(),apiUrl:e[1].trim(),locations:e[2].trim(),hasCdn:"Yes"===e[3].trim()})}})),r})))}const B={getActiveServer:()=>A().pipe(c((t=>{return l(t).pipe((e=t=>function(t){const e=n.getApi({baseUrl:t.apiUrl}),s=e.getTrendingVideos().pipe(y(500)),o=e.getStream("OgRoRBLZbUQ").pipe(y(500));return s.pipe(c((()=>o)),u((()=>!0)),r((()=>m(!1))))}(t).pipe(u((r=>{if(r)return t}))),h(s)?f(e,s,1):f(e,1)),d(Boolean),b(1),u((t=>t)),T((()=>new Error("No server found"))));var e,s})))};export{B as A,A as g,y as t}