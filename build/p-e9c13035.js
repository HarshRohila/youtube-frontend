import{h as s}from"./p-27ce4408.js";import{d as o,a as n,e,f as t}from"./p-9a472600.js";import{Y as r,c as i}from"./p-524a5bb9.js";import{s as a}from"./p-0874e72a.js";import{R as c}from"./p-954d5885.js";import{c as u,t as l}from"./p-e8d0ac2d.js";import{f}from"./p-675af075.js";import{t as g}from"./p-00460c93.js";import{s as m,o as p}from"./p-cff7c84c.js";import{b as h,i as d}from"./p-e202420a.js";import{o as v,c as b,e as x,i as S,m as j}from"./p-d991cb74.js";import{c as k}from"./p-90d81ce8.js";const C=k((s=>function(o=null){s(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=o}));function T(s){throw new C(s)}function w({onSearchSubmit:t,onSearchTextChange:r,onSearchBtnClick:i,searchText:a,showSearchbar:c,onCloseClick:u,onClickBack:l}){return s("div",{class:"search-bar"},l&&s("button",{class:"back",onClick:l},s("x-icon",{icon:e})),s("form",{class:"search-form "+(c?"":"hide"),onSubmit:s=>{s.preventDefault(),t(s)}},s("input",{type:"text",class:"search-input",value:a,placeholder:"Search",onInput:s=>{r(s)}})),c&&s("button",{class:"close",onClick:u},s("x-icon",{icon:n})),!c&&s("button",{class:"search",onClick:i},s("x-icon",{icon:o})))}function y({suggestions:o,onClickSuggesion:n,error:e,loading:r}){return s("div",{class:"suggestions-container"},e&&s("div",{class:"error"},e.message),r&&s("div",{class:"loading"},s("x-icon",{icon:t,spin:!0})),s("ul",{class:"suggestions"},!r&&!e&&o.map((o=>s("li",{key:o,onClick:()=>n(o)},o)))))}const L=u({showSearchBar:!1,searchText:"",searchResponse:{nextpage:"",results:[]},suggestions:[],suggestionsError:void 0,suggestionsLoading:!1});function E(s){L.update({suggestions:s})}function B(){L.update((s=>({showSearchBar:!s.showSearchBar,suggestions:s.showSearchBar?[]:s.suggestions})))}function F(s){L.update({searchText:s})}function P(s){L.update((o=>({suggestions:[],searchText:s||o.searchText})))}function R(s){L.update((o=>{const n=Object.assign({},o);return n.searchResponse=s,o.showSearchBar&&function(s){s.showSearchBar=!s.showSearchBar,s.showSearchBar||(s.suggestions=[])}(n),n}))}function I(s){L.update({suggestionsError:s})}function N(s){L.update({searchText:s})}const O="Failed to get response from the Server. Please try changing server from settings(in home page)";function V(s){return s.pipe(g((()=>{a.update({isLoading:!0})})),m((()=>r.getApi().getTrendingVideos().pipe(function(s,o){const{first:n,each:e,with:t=T,scheduler:r=(null!=o?o:h),meta:i=null}=d(s)?{first:s}:"number"==typeof s?{each:s}:s;if(null==n&&null==e)throw new TypeError("No timeout provided.");return v(((s,o)=>{let a,c,u=null,l=0;const f=s=>{c=x(o,r,(()=>{try{a.unsubscribe(),S(t({meta:i,lastValue:u,seen:l})).subscribe(o)}catch(s){o.error(s)}}),s)};a=s.subscribe(b(o,(s=>{null==c||c.unsubscribe(),l++,o.next(u=s),e>0&&f(e)}),void 0,void 0,(()=>{(null==c?void 0:c.closed)||null==c||c.unsubscribe(),u=null}))),!l&&f(null!=n?"number"==typeof n?n:+n-r.now():e)}))}(c),j((s=>R({results:s,nextpage:""}))),i((()=>(a.update({error:{message:O}}),p(R({results:[],nextpage:""})))))).pipe(g((()=>{a.update({isLoading:!1})}))))))}const Y=s=>o=>function(s,o){return s.pipe(f((s=>!!s.length)),function(s,o=h){return v(((n,e)=>{let t=null,r=null,i=null;const a=()=>{if(t){t.unsubscribe(),t=null;const s=r;r=null,e.next(s)}};function c(){const n=i+s,r=o.now();if(r<n)return t=this.schedule(void 0,n-r),void e.add(t);a()}n.subscribe(b(e,(n=>{r=n,i=o.now(),t||(t=o.schedule(c,s),e.add(t))}),(()=>{a(),e.complete()}),void 0,(()=>{r=t=null})))}))}(300),g((()=>{a.update({isLoading:!0}),I(void 0)})),m((s=>r.getApi().getSuggestions(s).pipe(g((s=>{E(s)})),i((()=>(I({message:"Failed to get Suggestions from the Server. Press Enter to Search"}),E([]),p([])))),g((()=>{a.update({isLoading:!1})})),l(o)))))}(o,s);function q(s){return s.pipe(f((s=>!!s.length)),g((()=>{a.update({isLoading:!0})})),m((s=>r.getApi().getSearchResults(s).pipe(j((s=>R(s))),i((()=>(a.update({error:{message:O}}),p(R({results:[],nextpage:""})))))).pipe(g((()=>{a.update({isLoading:!1})}))))))}export{y as S,N as a,w as b,P as c,q as d,V as f,Y as g,F as k,L as s,B as t}